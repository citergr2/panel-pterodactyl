#if 0
	shc Version 4.0.3, Generic Shell Script Compiler
	GNU GPL Version 3 Md Jahidul Hamid <jahidulhamid@yahoo.com>

	shc -f installpanel.sh -o installpanel 
#endif

static  char data [] = 
#define      lsto_z	1
#define      lsto	((&data[0]))
	"\351"
#define      chk1_z	22
#define      chk1	((&data[5]))
	"\125\107\374\175\055\076\273\200\122\327\037\071\153\132\273\210"
	"\166\155\235\024\050\310\314\003\210\065"
#define      text_z	6107
#define      text	((&data[736]))
	"\020\235\022\173\271\127\164\201\367\226\167\015\022\105\246\224"
	"\174\250\000\076\321\230\357\372\356\067\366\153\024\155\064\045"
	"\013\107\240\304\237\025\106\227\254\276\244\276\003\113\122\177"
	"\363\123\276\305\353\256\277\332\345\266\105\372\044\172\037\057"
	"\302\300\364\141\325\072\370\202\371\235\100\374\350\223\173\334"
	"\346\072\241\322\350\140\254\315\027\362\310\073\154\347\153\056"
	"\247\137\220\175\232\210\377\223\045\100\220\016\323\013\352\271"
	"\106\214\214\056\355\070\374\004\052\304\100\227\254\253\306\123"
	"\013\126\321\245\337\321\071\004\021\311\023\344\325\376\236\033"
	"\212\052\112\167\143\106\173\215\012\274\045\267\150\353\013\163"
	"\102\334\031\041\255\122\046\276\034\071\243\361\067\101\015\301"
	"\154\127\071\317\235\264\135\250\161\202\137\331\156\152\114\260"
	"\107\145\321\365\270\367\264\324\060\127\306\150\231\323\052\005"
	"\052\143\324\310\030\061\160\211\264\320\142\043\073\257\323\202"
	"\025\244\170\315\234\054\242\315\203\150\065\034\074\137\042\146"
	"\302\366\056\332\050\237\143\335\157\306\000\253\165\323\055\212"
	"\170\246\130\024\322\372\341\126\143\027\162\240\166\224\006\071"
	"\213\065\023\264\325\167\221\104\075\222\357\263\146\035\075\336"
	"\304\225\363\226\220\325\354\364\354\137\224\143\364\233\234\200"
	"\321\260\064\246\047\306\353\145\130\333\030\277\371\125\235\275"
	"\353\221\123\174\146\100\161\123\237\006\266\224\242\123\024\163"
	"\003\111\032\053\017\005\220\150\340\251\047\331\376\305\227\352"
	"\126\352\147\275\053\331\020\313\337\307\137\201\033\164\365\036"
	"\275\017\112\315\024\333\066\365\204\135\316\203\043\145\155\171"
	"\120\325\067\174\256\107\107\215\017\246\017\052\033\004\111\330"
	"\023\224\246\050\157\334\035\363\071\354\166\135\122\344\327\243"
	"\272\016\037\150\126\146\366\146\015\006\220\050\013\332\000\037"
	"\156\246\107\336\203\144\321\275\121\110\032\243\055\361\106\350"
	"\000\146\120\126\314\107\274\331\116\115\002\131\047\003\170\226"
	"\252\277\164\055\044\106\352\166\216\004\031\274\366\140\244\366"
	"\306\365\114\223\075\011\155\213\126\157\345\175\162\135\024\034"
	"\035\210\111\102\316\063\270\135\070\322\032\056\063\276\045\371"
	"\264\161\215\361\172\372\175\321\151\142\117\333\300\143\370\336"
	"\353\101\040\272\165\331\030\256\253\062\335\336\361\002\330\245"
	"\163\146\227\356\140\024\300\311\167\017\245\070\162\235\026\136"
	"\337\067\031\124\020\061\002\274\143\337\233\124\341\164\372\125"
	"\332\221\104\072\246\004\004\035\024\251\125\206\107\154\345\046"
	"\243\376\172\263\057\175\157\222\135\012\347\077\176\341\225\131"
	"\162\331\223\031\336\230\066\362\101\214\171\211\370\136\257\234"
	"\135\052\117\214\250\277\037\005\312\007\105\111\350\332\242\133"
	"\264\066\164\223\316\253\206\020\070\377\231\061\136\110\315\274"
	"\163\035\110\033\334\150\041\246\157\146\357\130\100\222\264\365"
	"\310\051\210\226\324\016\247\015\016\100\076\155\211\014\051\374"
	"\051\162\030\005\332\071\254\112\237\233\243\340\056\127\325\366"
	"\200\136\215\125\155\372\001\101\020\000\310\361\347\120\306\110"
	"\304\353\111\011\074\233\313\242\067\070\125\157\354\021\374\224"
	"\137\026\062\043\226\352\207\101\135\322\106\364\216\157\074\361"
	"\230\112\036\167\135\216\274\026\234\067\015\013\206\135\360\323"
	"\126\273\071\176\261\156\076\204\273\213\322\155\062\154\036\273"
	"\024\314\002\233\114\336\253\034\377\065\033\315\314\166\165\300"
	"\343\026\353\101\365\015\273\350\346\177\144\100\110\221\012\246"
	"\363\015\051\006\371\330\126\073\035\141\265\265\053\371\304\110"
	"\261\072\102\051\015\320\234\353\014\310\227\033\275\033\167\354"
	"\326\204\373\156\347\176\227\201\205\177\004\027\263\146\231\110"
	"\061\316\107\037\241\300\037\024\102\327\074\001\217\161\255\244"
	"\315\155\211\243\123\023\270\171\322\077\226\261\254\343\330\365"
	"\160\215\350\025\020\300\377\130\155\150\055\377\132\307\155\070"
	"\015\336\045\147\014\025\266\063\131\000\217\356\320\242\115\372"
	"\317\212\044\032\243\055\066\273\352\124\302\110\252\135\351\254"
	"\077\035\321\104\352\031\160\062\242\150\325\362\176\177\214\107"
	"\106\356\267\314\217\312\220\264\164\365\167\200\314\050\373\141"
	"\312\274\376\201\367\021\227\212\002\265\136\133\007\101\144\202"
	"\026\312\104\216\255\071\200\072\066\277\374\366\146\050\055\031"
	"\126\101\316\224\234\015\300\127\227\022\377\201\121\326\020\265"
	"\043\373\245\250\347\276\205\143\134\256\031\174\255\307\155\353"
	"\132\252\023\372\321\131\362\324\077\320\043\371\033\362\302\214"
	"\227\056\045\251\250\121\262\036\105\160\051\140\177\236\242\306"
	"\355\010\332\342\360\145\102\044\227\264\056\344\136\253\053\067"
	"\156\030\105\233\266\251\371\147\175\133\325\361\121\221\327\235"
	"\067\314\065\226\100\124\246\132\037\341\164\333\222\256\131\152"
	"\305\276\255\301\255\230\324\122\107\045\313\323\344\105\142\012"
	"\140\316\365\100\242\214\363\131\015\162\345\174\273\265\111\303"
	"\002\154\172\375\153\026\157\221\163\316\322\230\333\075\377\134"
	"\273\221\363\117\003\017\051\006\123\063\011\224\020\015\037\251"
	"\360\264\335\255\000\264\307\255\131\376\033\172\332\215\363\070"
	"\136\325\024\223\330\230\233\152\226\134\044\363\022\200\155\274"
	"\164\311\133\042\174\304\372\063\115\373\137\316\272\041\036\143"
	"\242\367\232\022\374\217\054\265\133\343\074\362\005\300\155\371"
	"\225\132\227\251\142\351\122\036\320\015\304\057\353\340\352\242"
	"\104\117\064\241\041\255\233\042\265\313\062\100\347\021\003\343"
	"\042\144\051\241\257\202\067\165\001\322\312\202\127\320\133\216"
	"\026\000\162\354\244\031\043\052\051\221\244\303\375\301\255\166"
	"\007\200\255\232\340\152\120\371\102\153\155\152\077\016\312\054"
	"\150\212\044\277\120\365\010\217\217\045\032\253\173\245\123\156"
	"\150\101\370\330\062\254\271\353\326\250\151\076\003\333\226\112"
	"\302\167\173\363\243\302\267\177\340\017\016\110\023\224\026\015"
	"\121\015\070\155\271\105\256\340\045\012\234\201\321\316\133\340"
	"\211\127\315\037\160\220\255\214\216\127\303\165\325\141\144\105"
	"\274\131\146\020\123\261\364\107\233\035\237\247\225\100\310\014"
	"\120\336\272\051\016\057\271\266\235\361\257\015\361\376\001\226"
	"\103\326\265\200\006\273\177\101\160\117\352\133\044\067\311\011"
	"\336\004\031\222\003\372\115\205\067\242\175\131\346\206\221\262"
	"\161\056\363\242\176\274\074\257\253\312\373\245\121\143\161\276"
	"\172\211\103\226\341\216\227\174\014\003\313\310\144\251\371\063"
	"\136\357\005\335\005\375\204\322\365\154\056\116\212\137\113\244"
	"\271\077\046\234\373\015\005\255\327\042\114\142\302\215\112\370"
	"\120\252\201\132\200\132\216\205\222\303\341\023\272\314\177\364"
	"\320\271\050\003\061\302\231\067\345\360\022\246\372\263\202\253"
	"\165\003\352\100\250\321\073\076\024\007\153\162\063\355\356\256"
	"\237\174\310\045\114\033\206\320\307\111\221\220\375\014\312\304"
	"\321\073\067\011\216\053\360\025\204\214\256\002\176\277\133\175"
	"\164\110\233\313\147\014\213\144\301\245\203\034\261\310\105\261"
	"\007\007\203\021\165\344\066\163\330\233\027\233\160\033\240\077"
	"\051\034\167\312\250\105\362\050\074\352\064\304\067\103\157\030"
	"\257\215\177\146\165\255\012\204\207\051\054\166\207\306\210\005"
	"\151\015\176\233\244\277\053\310\370\206\372\230\066\111\164\317"
	"\124\306\352\253\014\227\353\203\025\346\101\054\353\012\014\212"
	"\124\220\367\266\005\172\255\371\065\161\034\215\300\132\147\265"
	"\260\223\260\072\277\075\033\173\147\306\074\156\177\010\276\233"
	"\071\117\370\211\310\274\202\063\036\172\105\154\100\020\300\303"
	"\027\103\100\357\076\350\101\255\027\267\275\227\112\113\334\304"
	"\254\322\313\154\045\051\012\251\201\333\153\177\336\305\176\136"
	"\120\212\260\306\052\014\154\051\150\145\331\111\037\351\311\361"
	"\352\373\360\300\326\025\164\367\204\166\247\057\162\050\104\037"
	"\351\173\037\234\302\137\350\300\077\277\127\002\254\246\214\134"
	"\016\225\343\103\036\306\200\021\062\314\265\235\034\025\343\042"
	"\003\153\273\004\042\001\210\340\270\027\115\134\274\060\040\202"
	"\262\346\016\163\035\111\300\002\070\161\366\367\267\103\145\243"
	"\367\237\276\276\316\123\136\220\275\137\040\127\232\342\073\153"
	"\304\023\341\331\230\024\147\111\274\326\330\153\367\203\274\067"
	"\226\300\211\044\061\161\102\207\012\131\326\237\226\065\074\273"
	"\061\307\021\334\262\211\130\103\346\132\124\035\244\264\120\044"
	"\314\232\072\155\011\332\274\140\124\136\017\210\147\246\345\313"
	"\101\060\276\215\377\300\007\176\051\015\143\336\156\354\014\052"
	"\074\101\137\157\017\255\270\157\150\356\067\301\204\007\043\046"
	"\131\316\075\014\232\205\231\357\056\165\253\237\210\265\221\334"
	"\207\021\024\175\167\116\316\113\373\043\301\223\175\302\314\244"
	"\322\233\274\006\036\117\066\113\167\067\220\266\235\057\130\252"
	"\256\135\227\066\136\156\147\015\165\344\132\316\077\261\360\354"
	"\352\233\124\321\163\005\173\120\137\300\312\143\036\217\251\074"
	"\030\226\024\220\270\375\327\023\111\042\335\113\020\333\375\351"
	"\255\037\065\273\124\000\130\235\301\102\245\051\147\355\167\131"
	"\370\044\303\016\062\355\220\154\023\033\160\052\036\332\232\316"
	"\347\104\116\061\132\035\230\041\026\304\336\232\143\036\347\247"
	"\147\214\131\225\157\055\266\222\251\240\100\365\041\132\066\202"
	"\276\104\015\152\245\145\373\277\215\132\063\215\112\334\264\225"
	"\141\367\040\341\134\207\275\043\121\332\075\153\174\365\016\206"
	"\007\037\205\324\262\051\102\047\015\067\336\101\003\016\300\042"
	"\103\167\275\114\006\362\330\056\244\011\221\313\212\040\356\075"
	"\363\105\305\076\372\337\023\341\336\342\107\337\016\014\007\014"
	"\277\161\355\162\324\046\205\325\204\220\127\264\000\123\356\170"
	"\276\376\064\211\114\227\204\343\063\104\326\343\107\215\324\053"
	"\005\243\277\003\050\340\173\253\332\140\064\127\064\372\202\336"
	"\074\127\035\263\053\146\321\063\342\372\150\147\161\271\237\240"
	"\347\130\227\304\021\021\357\006\265\071\336\246\163\205\225\070"
	"\036\364\265\045\124\230\041\123\314\016\100\016\130\103\113\111"
	"\043\300\234\154\301\203\127\361\152\224\245\045\036\223\143\046"
	"\325\130\367\232\036\005\251\063\312\203\305\274\164\207\263\050"
	"\117\320\045\072\364\300\326\360\055\044\060\263\121\144\320\114"
	"\225\135\374\005\301\024\306\150\303\206\055\053\107\213\140\325"
	"\117\170\340\357\363\336\314\156\114\265\045\211\131\207\327\021"
	"\110\255\116\217\074\322\345\013\220\055\144\346\302\252\031\136"
	"\152\234\325\253\026\306\327\375\156\270\340\120\275\014\304\021"
	"\215\007\207\070\344\321\204\034\227\375\217\322\107\166\372\106"
	"\305\042\142\001\302\120\014\206\131\373\103\352\003\273\256\166"
	"\055\133\264\125\116\342\111\004\172\133\056\051\270\024\263\311"
	"\155\175\010\176\133\245\235\310\223\157\223\211\256\126\014\153"
	"\271\226\151\343\042\176\315\107\263\065\062\153\177\254\332\245"
	"\113\342\156\355\333\323\246\001\253\332\375\363\170\106\311\323"
	"\321\152\321\147\031\233\206\126\217\150\026\336\337\051\367\212"
	"\013\336\037\301\130\030\354\207\022\106\252\362\007\113\040\077"
	"\013\054\272\214\276\046\243\117\330\241\174\266\073\273\265\045"
	"\212\172\156\317\054\372\054\274\230\320\163\350\316\110\061\014"
	"\017\227\000\125\252\000\050\067\125\106\260\100\231\152\041\325"
	"\265\317\004\204\057\152\363\251\273\362\053\127\127\140\320\130"
	"\337\030\024\201\270\007\116\053\104\172\046\263\320\361\224\226"
	"\263\134\133\132\170\056\055\234\157\147\015\115\153\132\127\340"
	"\363\112\075\000\256\274\313\020\304\035\016\261\025\213\020\176"
	"\324\366\363\203\140\336\241\207\303\212\001\270\236\344\227\107"
	"\302\335\105\210\147\147\362\174\203\305\046\142\313\225\255\347"
	"\217\035\247\351\131\115\070\142\054\254\265\033\075\350\212\230"
	"\143\067\025\223\012\042\226\246\361\301\027\234\102\106\055\316"
	"\211\355\205\044\015\257\363\010\221\336\102\373\112\212\261\231"
	"\206\206\240\247\202\337\323\235\332\324\304\254\343\357\102\044"
	"\075\251\076\272\335\270\067\014\356\312\127\236\166\324\123\254"
	"\237\303\061\151\223\070\331\232\040\266\254\047\004\336\303\065"
	"\315\012\035\124\313\204\215\271\040\017\307\060\026\141\301\260"
	"\370\023\204\134\364\005\175\010\004\004\322\237\371\007\231\306"
	"\061\012\225\020\131\041\132\120\140\263\240\004\357\210\122\131"
	"\062\360\247\170\170\041\261\216\343\156\311\255\202\235\337\064"
	"\240\126\171\203\326\371\150\236\224\277\203\006\134\146\003\134"
	"\100\101\275\321\000\225\240\367\100\034\230\350\362\364\302\070"
	"\207\355\064\303\027\371\130\036\022\015\133\073\114\303\204\152"
	"\204\317\300\156\052\317\346\003\332\162\235\266\206\157\277\244"
	"\302\153\227\377\121\206\377\211\002\071\344\106\252\226\240\324"
	"\305\344\124\307\371\362\034\064\156\272\232\320\027\346\140\334"
	"\205\153\343\343\321\047\070\055\320\131\127\157\313\314\155\132"
	"\005\226\265\240\066\234\045\143\275\324\035\332\203\351\174\117"
	"\315\110\147\330\213\275\355\067\043\151\312\043\216\033\111\144"
	"\073\006\033\174\043\151\033\226\261\021\221\072\112\215\167\232"
	"\303\123\212\067\000\301\236\055\251\254\121\172\132\274\035\342"
	"\060\302\253\124\177\265\011\104\103\355\211\013\237\342\313\146"
	"\137\177\364\117\341\113\214\216\323\374\243\132\074\103\110\054"
	"\320\176\337\154\262\270\220\302\110\243\370\334\116\105\151\334"
	"\123\054\000\362\021\374\176\124\036\233\064\125\067\162\072\157"
	"\055\372\332\127\332\167\015\125\016\167\061\104\356\073\354\156"
	"\214\250\073\162\057\344\331\264\066\164\225\151\010\166\047\060"
	"\110\056\044\007\336\372\053\102\000\236\120\146\026\036\161\074"
	"\006\100\035\361\207\261\274\307\037\026\374\131\112\150\115\315"
	"\136\331\255\345\010\160\377\205\322\027\065\040\362\140\166\245"
	"\366\361\141\213\020\303\312\175\022\107\143\300\171\272\375\263"
	"\011\172\141\146\364\160\370\023\322\072\107\360\175\374\044\117"
	"\321\256\151\375\173\015\032\333\061\377\045\053\251\066\235\121"
	"\174\361\125\351\367\171\127\027\276\151\371\050\257\011\032\023"
	"\204\362\006\112\164\040\062\116\164\253\162\334\101\207\037\141"
	"\342\202\204\151\014\304\106\022\170\241\211\273\350\351\113\326"
	"\003\365\377\143\066\325\133\133\274\245\376\207\033\167\167\250"
	"\176\350\306\071\371\130\153\237\053\333\176\315\124\366\036\326"
	"\127\141\074\172\110\002\264\066\174\374\032\350\350\337\342\331"
	"\267\357\065\107\257\223\335\322\274\037\261\115\354\056\332\204"
	"\367\260\346\030\007\003\267\207\347\324\304\330\246\167\231\162"
	"\257\057\256\023\361\006\055\025\362\021\301\303\164\326\141\127"
	"\277\242\143\205\274\075\114\065\016\271\334\146\052\353\053\055"
	"\353\043\101\144\002\231\236\157\234\061\026\077\252\211\276\255"
	"\161\045\234\064\012\277\026\106\275\115\161\033\340\237\267\307"
	"\160\100\017\061\122\333\350\234\211\167\116\240\345\053\121\176"
	"\074\017\113\303\371\032\042\342\200\111\034\377\232\312\222\100"
	"\342\017\330\235\004\332\275\133\311\157\275\176\270\070\222\263"
	"\262\236\277\022\244\111\336\363\121\033\330\124\057\050\227\022"
	"\344\154\025\026\346\353\251\323\216\024\362\003\273\344\107\057"
	"\343\366\312\176\072\320\111\064\366\266\075\277\377\270\265\137"
	"\261\070\371\164\047\224\277\202\302\136\336\161\376\355\117\200"
	"\026\167\360\214\121\117\231\261\336\206\174\223\012\217\210\112"
	"\152\367\315\300\124\104\375\172\032\222\000\265\340\347\032\003"
	"\133\354\013\117\207\345\346\216\363\061\071\023\212\200\057\176"
	"\064\241\247\012\343\321\315\060\275\234\161\130\312\024\116\102"
	"\075\324\375\154\173\177\303\073\305\172\207\126\302\134\344\151"
	"\104\073\374\224\376\342\267\324\042\066\332\102\332\076\355\140"
	"\357\052\011\233\036\271\306\030\350\255\011\255\134\313\144\341"
	"\334\212\061\167\267\164\151\312\366\057\135\214\130\064\302\343"
	"\231\077\225\127\325\344\301\141\073\013\356\365\306\204\015\320"
	"\254\255\176\033\173\321\233\211\323\045\347\345\165\205\031\013"
	"\324\067\345\045\172\273\170\033\067\107\266\221\217\230\211\024"
	"\103\047\346\252\141\044\161\230\220\253\056\256\244\002\164\373"
	"\362\224\255\022\012\265\227\345\362\315\312\246\240\241\321\326"
	"\217\215\116\141\064\171\112\253\157\300\103\160\204\026\237\013"
	"\110\250\042\177\277\033\211\134\241\330\062\077\367\003\163\233"
	"\163\326\131\102\365\147\070\343\373\032\051\111\074\026\242\302"
	"\161\247\273\102\107\254\146\103\113\253\015\053\354\301\262\133"
	"\117\342\023\227\106\105\032\076\210\270\175\356\021\251\063\117"
	"\005\203\121\150\034\130\002\054\303\033\052\361\201\010\357\350"
	"\027\322\352\352\356\017\274\047\103\352\156\226\217\162\252\345"
	"\055\351\255\240\350\215\265\112\146\361\230\273\214\225\036\230"
	"\030\076\346\311\326\262\023\370\257\310\361\363\140\017\322\377"
	"\176\214\101\021\127\213\252\210\014\372\136\203\142\256\310\375"
	"\003\223\010\355\347\103\261\162\302\141\106\001\150\054\371\227"
	"\362\142\167\077\352\325\172\010\157\235\171\111\076\031\122\005"
	"\251\047\076\344\204\334\073\027\033\340\235\114\335\262\264\202"
	"\136\141\210\020\107\250\005\013\021\337\030\274\201\016\005\356"
	"\314\166\206\342\237\330\242\263\315\073\024\376\300\260\255\012"
	"\225\054\336\150\210\301\140\110\354\255\324\004\330\367\050\114"
	"\012\206\367\234\350\365\112\340\366\164\024\165\213\130\320\004"
	"\073\142\373\337\221\121\141\117\302\164\155\114\310\050\314\061"
	"\302\315\043\312\126\335\375\034\150\057\123\313\126\310\336\221"
	"\334\376\341\135\370\067\026\007\103\244\270\113\370\020\315\174"
	"\036\360\273\217\053\223\152\325\373\254\360\214\224\110\371\105"
	"\213\272\370\062\256\145\111\017\066\236\060\344\336\062\235\277"
	"\363\174\166\144\364\105\066\244\336\315\326\065\164\124\273\317"
	"\177\260\176\030\302\250\376\160\017\164\370\152\076\005\054\317"
	"\211\241\176\330\127\312\200\215\244\143\077\221\100\263\277\151"
	"\211\170\202\234\101\077\223\132\122\337\044\134\054\143\357\061"
	"\166\274\107\253\004\363\313\022\353\060\173\313\266\103\206\170"
	"\352\365\214\127\253\130\257\140\021\267\361\233\005\104\362\074"
	"\125\074\136\117\021\165\124\202\052\206\173\301\115\075\213\005"
	"\331\137\312\257\215\225\000\061\211\060\003\154\105\134\346\152"
	"\274\153\143\345\355\320\120\301\101\252\362\267\062\344\054\271"
	"\367\220\012\057\153\073\315\055\025\327\310\223\044\027\132\351"
	"\323\323\240\312\005\267\236\264\017\042\055\272\152\232\243\053"
	"\306\117\353\105\213\163\230\166\346\367\102\066\020\367\101\065"
	"\240\310\142\123\202\043\231\155\203\151\312\310\240\232\021\007"
	"\347\304\004\344\241\277\353\330\340\150\247\076\222\060\156\151"
	"\024\023\016\310\142\036\203\037\011\067\126\312\251\125\061\203"
	"\115\364\125\327\113\014\370\004\313\321\066\123\067\336\364\006"
	"\060\133\055\235\112\014\036\243\140\020\174\201\375\223\327\212"
	"\317\132\357\013\201\027\133\030\346\206\313\252\063\207\100\053"
	"\020\315\152\165\263\035\142\302\336\055\334\147\126\263\367\215"
	"\302\066\277\206\276\366\212\276\270\152\210\373\243\017\252\305"
	"\265\232\060\051\363\110\276\364\231\172\133\135\366\156\337\367"
	"\167\005\072\061\340\331\361\243\115\134\342\225\367\320\014\026"
	"\021\017\353\365\000\147\311\017\341\120\021\122\012\177\355\143"
	"\365\143\263\372\074\305\051\363\221\017\213\106\161\125\220\345"
	"\155\364\064\237\002\031\125\121\370\325\010\176\066\337\220\362"
	"\153\334\054\034\023\244\172\027\200\040\320\163\172\174\262\374"
	"\312\176\206\106\224\344\263\162\104\075\147\376\160\030\131\244"
	"\355\142\057\273\124\201\000\211\215\056\125\311\102\074\167\237"
	"\243\315\265\136\323\267\363\011\002\116\213\247\310\354\132\001"
	"\144\035\350\365\165\123\333\256\250\254\042\215\303\302\365\022"
	"\253\110\045\356\372\367\377\105\206\030\043\046\220\376\361\231"
	"\122\072\141\145\173\176\261\110\061\033\152\057\302\161\221\277"
	"\361\251\101\337\022\020\251\146\021\350\067\201\374\027\036\326"
	"\110\013\134\025\172\176\171\032\157\207\010\336\007\144\115\176"
	"\107\210\010\221\101\176\172\160\306\353\332\052\221\337\073\117"
	"\066\373\006\111\155\113\162\277\233\040\003\341\351\353\103\127"
	"\015\033\033\334\017\005\377\316\270\152\346\224\025\036\224\324"
	"\043\147\202\164\002\067\136\162\052\075\213\236\117\022\135\117"
	"\162\307\170\137\155\106\117\102\112\366\251\344\132\231\322\164"
	"\175\327\244\104\017\211\056\073\037\152\330\175\051\065\020\216"
	"\353\213\265\003\242\237\060\337\136\057\206\053\355\102\300\074"
	"\062\337\047\304\243\151\252\366\153\127\032\224\346\270\335\170"
	"\126\023\111\347\226\263\177\125\106\237\113\053\031\321\125\260"
	"\012\273\273\376\246\165\211\135\257\114\226\365\265\077\260\057"
	"\301\206\013\255\152\362\306\046\314\257\031\077\167\137\201\363"
	"\071\047\341\223\377\340\110\275\231\332\301\115\021\152\067\166"
	"\322\337\112\313\375\072\116\126\112\372\106\021\046\360\164\275"
	"\066\124\114\101\310\176\356\007\000\371\076\160\367\125\373\056"
	"\117\102\363\151\325\126\372\100\247\342\224\234\325\137\305\362"
	"\101\076\303\275\155\344\263\047\216\224\047\007\213\253\342\352"
	"\310\323\261\144\157\337\240\255\122\170\121\351\140\370\242\366"
	"\213\011\170\257\133\134\357\332\353\034\336\235\320\006\015\145"
	"\031\072\321\254\362\152\233\057\274\302\006\050\307\337\253\344"
	"\047\336\147\251\330\101\012\357\057\350\041\232\357\023\174\245"
	"\220\147\230\152\063\271\360\304\350\027\043\362\031\324\171\016"
	"\205\015\315\244\232\112\334\014\117\166\353\135\004\347\161\046"
	"\034\325\163\203\077\236\115\223\347\161\036\271\202\032\276\172"
	"\116\374\312\077\043\143\215\071\236\154\243\146\116\146\175\113"
	"\024\276\127\132\307\007\221\372\272\355\371\360\075\324\043\312"
	"\307\106\231\314\320\161\164\225\164\202\015\344\325\203\344\354"
	"\134\010\134\357\144\300\313\356\065\254\362\114\107\115\225\124"
	"\055\223\205\252\341\376\125\022\071\317\103\350\210\254\207\037"
	"\154\326\041\305\252\114\161\101\124\000\072\025\034\377\362\135"
	"\032\354\260\030\326\366\377\037\170\372\016\123\022\053\250\253"
	"\177\166\310\130\154\264\054\043\053\251\235\322\040\204\055\261"
	"\277\321\005\032\322\224\054\365\121\310\154\066\223\200\162\206"
	"\054\301\301\126\325\013\162\032\333\276\311\306\051\263\212\003"
	"\207\103\243\320\355\337\206\337\167\242\306\361\140\200\344\012"
	"\033\150\172\252\035\270\202\157\266\325\111\007\250\242\235\251"
	"\045\322\002\330\270\251\063\010\364\264\321\244\145\364\343\115"
	"\006\151\333\307\317\301\371\241\225\037\064\026\205\324\174\253"
	"\125\164\067\360\315\132\264\377\164\354\333\306\134\242\244\005"
	"\135\300\210\147\064\131\172\352\055\061\362\276\373\265\355\224"
	"\243\363\352\374\156\060\150\103\277\247\352\101\074\056\360\166"
	"\272\035\245\036\260\061\264\342\264\374\127\363\112\142\256\246"
	"\361\347\121\116\227\277\236\241\303\233\375\117\040\156\121\101"
	"\304\214\250\334\030\115\263\146\025\335\235\302\161\115\303\065"
	"\346\351\262\015\172\171\035\325\116\000\311\323\315\064\327\043"
	"\034\350\310\172\331\313\273\263\160\054\021\276\116\351\357\301"
	"\307\076\232\127\300\307\036\042\370\275\306\164\213\371\331\052"
	"\176\161\174\023\220\250\342\221\362\160\023\365\373\032\370\346"
	"\321\274\250\146\164\165\251\070\104\365\011\262\212\072\310\152"
	"\056\366\247\176\333\344\350\036\331\207\335\232\272\163\051\365"
	"\133\113\040\042\336\145\153\207\107\166\047\334\323\352\350\147"
	"\102\144\126\361\237\230\155\017\052\324\333\070\326\060\316\141"
	"\020\257\134\362\041\115\226\246\335\300\257\237\115\206\315\201"
	"\072\342\200\212\067\341\003\161\140\107\216\211\200\117\264\271"
	"\220\000\354\221\105\355\315\247\072\017\031\061\014\000\316\305"
	"\203\101\371\316\272\165\254\336\272\203\143\135\147\337\375\107"
	"\245\077\160\113\224\111\353\333\320\015\165\127\304\246\372\332"
	"\176\114\171\045\047\267\246\044\226\052\000\012\272\022\275\075"
	"\233\203\010\160\265\262\034\052\342\270\125\214\136\112\030\312"
	"\065\111\135\043\167\343\264\043\377\027\151\111\242\365\136\017"
	"\215\353\161\252\276\230\210\341\127\260\037\056\073\141\000\332"
	"\176\244\343\007\066\011\331\375\002\124\216\144\343\216\034\246"
	"\015\253\004\060\114\356\250\117\172\352\271\025\251\302\310\172"
	"\115\252\174\171\366\221\366\264\325\157\241\356\343\155\312\162"
	"\075\033\127\176\233\010\274\077\155\301\107\315\123\057\362\124"
	"\055\076\302\212\161\127\241\054\353\137\331\273\343\273\226\140"
	"\036\235\074\153\012\110\075\214\346\156\074\366\273\273\374\220"
	"\064\241\111\247\067\304\354\175\307\036\277\126\133\012\251\001"
	"\346\035\352\265\135\375\345\246\332\114\040\147\160\264\140\306"
	"\160\111\001\156\234\123\216\116\234\110\360\272\164\231\223\362"
	"\053\141\121\021\212\230\245\362\174\100\344\273\314\026\111\241"
	"\222\041\330\061\154\301\303\024\341\371\301\005\142\366\233\021"
	"\255\106\033\047\062\221\063\373\247\144\370\215\102\232\153\110"
	"\067\170\371\226\240\334\373\354\312\072\203\020\004\237\342\145"
	"\201\327\316\135\373\332\066\152\272\250\176\262\125\262\250\102"
	"\307\107\051\203\253\232\076\315\354\053\313\250\334\303\164\075"
	"\007\240\202\316\126\273\252\266\312\020\034\133\000\305\212\373"
	"\332\355\333\360\320\213\006\320\104\115\102\366\201\330\142\317"
	"\022\005\276\147\237\003\243\241\037\367\123\073\002\247\021\224"
	"\052\052\210\314\227\036\065\146\360\016\135\150\371\151\340\204"
	"\014\175\037\265\127\264\104\124\226\121\010\145\374\070\245\355"
	"\110\166\326\165\166\122\066\040\260\223\117\177\112\337\157\025"
	"\065\247\150\237\160\206\052\171\264\352\015\163\036\215\015\115"
	"\265\003\215\315\104\343\206\005\117\263\154\034\323\273\372\306"
	"\261\260\036\103\057\246\036\343\354\245\201\246\264\037\223\221"
	"\022\146\370\231\025\320\155\153\117\032\111\130\131\330\156\075"
	"\307\346\040\104\126\305\373\310\246\210\056\153\245\121\230\116"
	"\005\252\277\026\277\231\052\161\213\157\133\301\210\113\114\132"
	"\065\323\234\015\127\351\134\211\312\274\341\236\366\067\227\170"
	"\117\056\244\040\140\112\115\155\054\262\005\165\171\357\036\145"
	"\031\106\310\361\137\157\365\104\135\076\015\374\240\202\217\137"
	"\214\101\363\152\141\161\032\252\253\372\106\176\361\203\101\267"
	"\061\221\371\075\272\243\160\013\227\353\012\175\152\003\275\003"
	"\067\213\025\020\073\004\147\310\146\253\134\127\044\155\156\114"
	"\244\072\303\376\025\104\010\214\341\343\134\153\045\050\111\031"
	"\107\003\073\131\175\125\215\121\071\016\343\177\043\311\267\354"
	"\335\307\173\317\151\367\210\045\147\234\221\174\361\320\206\152"
	"\266\344\131\306\025\165\311\014\117\266\254\373\164\200\030\326"
	"\104\204\342\306\037\342\071\166\157\074\346\124\247\211\233\220"
	"\374\353\114\332\246\034\233\041\035\322\122\057\226\026\345\021"
	"\261\147\330\256\251\120\023\101\201\176\010\236\274\276\013\052"
	"\177\244\020\014\140\175\336\150\075\233\362\145\133\252\134\207"
	"\076\211\054\151\141\331\051\300\045\226\127\360\270\030\273\302"
	"\255\263\276\272\251\165\072\330\361\251\244\355\362\124\365\252"
	"\207\176\131\137\311\175\276\337\104\230\303\007\240\230\174\067"
	"\256\013\363\361\333\117\157\313\040\203\127\211\137\352\171\351"
	"\213\360\175\273\241\110\044\261\354\061\157\156\162\332\265\011"
	"\110\222\033\027\373\317\032\242\321\372\102\207\221\006\372\177"
	"\373\375\044\013\073\152\174\220\047\203\132\265\051\030\303\063"
	"\170\006\201\330\106\243\072\012\001\360\010\230\312\253\356\126"
	"\355\310\046\221\061\253\140\037\316\117\003\335\214\254\133\127"
	"\056\123\025\236\321\260\305\236\065\277\013\377\214\135\351\007"
	"\245\355\234\223\052\053\350\111\124\122\371\212\074\344\325\045"
	"\364\024\002\030\111\046\076\003\033\066\252\216\167\242\220\236"
	"\272\224\017\305\343\352\250\015\313\245\160\321\206\113\007\330"
	"\156\017\205\136\322\232\305\324\237\014\271\244\123\202\111\120"
	"\043\235\345\010\224\217\001\223\316\266\351\201\134\205\333\326"
	"\313\104\012\146\270\255\236\327\153\324\166\110\256\316\215\050"
	"\207\226\110\115\213\207\212\043\061\173\300\377\362\101\113\372"
	"\170\302\015\251\361\112\041\213\021\301\130\235\375\174\112\313"
	"\107\220\037\077\336\153\341\127\003\363\327\311\050\163\212\347"
	"\207\054\357\047\243\026\261\065\272\260\173\301\133\030\344\241"
	"\237\150\174\021\134\201\365\322\264\231\370\156\176\045\173\325"
	"\141\045\126\343\017\201\107\162\154\150\144\223\324\024\017\123"
	"\351\215\212\205\321\305\224\132\207\131\221\006\122\350\310\136"
	"\315\006\354\056\062\346\241\115\204\257\227\067\370\232\203\070"
	"\205\341\023\257\154\314\303\207\037\056\046\051\271\242\216\012"
	"\207\157\256\312\066\377\203\341\055\073\315\153\133\230\113\062"
	"\000\104\076\271\272\241\226\211\345\177\061\352\150\215\322\074"
	"\072\144\053\340\262\144\110\353\142\101\130\154\174\266\040\302"
	"\303\246\275\362\255\010\260\075\210\255\031\046\251\312\101\103"
	"\256\377\323\323\241\131\025\077\000\030\264\033\041\065\207\276"
	"\122\320\270\142\362\063\346\242\374\103\074\203\366\364\047\145"
	"\170\214\230\121\134\005\215\214\017\247\221\244\340\345\235\033"
	"\207\371\371\265\264\104\340\211\330\030\317\376\316\013\247\124"
	"\335\313\301\265\360\111\272\145\205\104\357\115\275\362\325\010"
	"\065\143\173\165\241\351\377\255\022\373\326\204\023\334\137\115"
	"\210\252\354\044\115\315\122\245\243\111\046\001\327\173\156\014"
	"\337\352\202\200\323\201\056\345\174\005\152\220\341\312\335\152"
	"\164\312\216\301\227\341\147\072\053\215\074\002\011\252\016\350"
	"\225\220\150\150\022\227\116\216\235\271\037\177\203\375\351\367"
	"\310\170\271\140\131\040\233\205\256\327\207\267\202\226\237\027"
	"\047\010\200\071\237\316\310\075\210\350\274\013\345\245\003\256"
	"\036\275\016\167\336\251\375\214\201\204\103\003\033\342\033\102"
	"\352\233\174\212\152\105\307\362\055\203\376\023\051\001\301\107"
	"\276\320\277\234\171\274\050\372\101\154\376\134\116\031\237\071"
	"\265\034\304\037\141\213\022\217\017\020\242\071\022\144\200\321"
	"\064\100\156\256\374\227\251\076\003\250\233\122\301\072\213\167"
	"\126\117\226\270\333\251\107\353\271\352\044\314\116\245\235\203"
	"\345\013\062\342\243\333\040\246\204\273\370\105\366\203\274\115"
	"\323\123\005\257\374\115\232\266\067\276\203\205\143\041\011\110"
	"\055\073\053\320\027\113\166\233\007\156\341\375\362\236\112\306"
	"\361\120\165\356\235\017\245\324\316\050\132\061\112\143\172\167"
	"\237\245\107\266\361\275\121\370\054\062\366\037\320\101\345\302"
	"\221\133\261\056\152\126\003\071\177\135\153\311\301\346\101\140"
	"\214\210\026\175\105\150\166\162\233\154\221\154\256\167\057\077"
	"\322\340\156\075\067\161\167\267\317\342\201\221\310\302\361\124"
	"\112\010\322\220\161\110\003\014\265\224\170\143\014\247\243\337"
	"\210\021\034\277\203\223\167\123\166\370\344\076\272\325\223\005"
	"\336\145\226\117\256\231\133\143\056\324\307\072\174\153\031\005"
	"\174\066\305\000\312\074\123\100\064\067\177\357\015\022\365\354"
	"\170\213\073\046\045\227\212\123\154\122\215\351\275\247\356\072"
	"\336\263\072\250\360\216\351\044\306\151\024\323\174\012\277\364"
	"\225\373\032\272\222\245\016\377\367\234\350\265\103\327\357\042"
	"\212\052\312\173\270\264\240\176\036\264\122\232\277\022\216\124"
	"\015\251\017\240\116\036\237\106\272\210\373\375\137\352\037\352"
	"\024\352\145\314\237\005\113\275\272\235\127\171\257\346\316\274"
	"\217\336\135\336\374\375\044\266\205\037\264\345\012\324\320\036"
	"\277\066\353\136\074\067\034\367\324\164\161\203\132\100\100\351"
	"\036\236\307\033\233\354\322\041\013\206\007\026\133\330\065\032"
	"\016\041\171\113\130\226\102\054\012\263\260\144\363\361\116\022"
	"\217\026\056\052\002\000\114\016\207\124\045\342\054\132\375\072"
	"\173\167\206\323\015\310\377\030\174\260\175\160\241\313\203\060"
	"\342\261\133\345\261\250\363\071\374\031\033\050\163\031\143\356"
	"\220\351\302\236\262\302\266\056\162\063\237\024\377\042\104\341"
	"\324\240\306\206\110\272\277\105\323\333\155\107\364\320\065\204"
	"\272\370\043\154\272\331\233\055\015\072\101\014\135\206\355\061"
	"\047\264\270\160\156\167\265\102\122\043\211\106\364\277\313\256"
	"\267\356\032\162\310\266\237\325\360\341\342\116\147\317\200\216"
	"\204\070\376\363\257\264\065\002\327\277\110\313\176\024\171\066"
	"\003\224\250\313\112\110\241\073\051\203\211\221\123\012\040\327"
	"\102\036\312\362\322\000\364\252\277\075\165\075\121\357\163\124"
	"\203\034\040\316\144\301\012\216\104\224\037\230\236\077\157\341"
	"\136\072\323\061\072\310\333\372\005\120\067\127\100\253\253\304"
	"\307\314\222\054\215\234\272\322\060\331\152\317\031\332\260\167"
	"\024\203\250\117\114\203\111\121\324\201\251\025\054\124\331\364"
	"\041\153\040\256\010\332\201\071\264\354\010\315\306\270\104\333"
	"\074\355\052\210\161\164\332\106\365\203\133\042\330\064\026\371"
	"\240\067\250\250\022\052\341\306\026\351\224\334\242\331\270\336"
	"\306\343\147\067\127\101\175\115\305\331\160\235\015\206\227\255"
	"\276\100\126\320\152\067\227\200\041\053\135\303\004\025\241\313"
	"\370\010\002\120\112\200\236\017\131\016\255\147\225\105\024\123"
	"\205\152\044\357\242\273\157\303\346\315\206\353\342\050\266\333"
	"\061\271\054\173\071\312\213\223\330\071\372\155\176\017\301\004"
	"\172\345\364\035\241\144\340\210\061\147\163\023\217\052\357\300"
	"\343\033\074\035\345\310\260\276\001\253\054\200\273\356\205\065"
	"\324\171\122\165\335\063\375\016\232\160\042\052\232\022\352\176"
	"\055\047\233\023\357\113\322\361\367\376\162\262\355\367\347\301"
	"\161\072\066\116\156\063\135\010\244\177\062\077\222\035\275\277"
	"\104\130\323\064\244\245\045\233\244\230\115\221\217\065\122\001"
	"\160\211\117\336\274\254\347\141\054\032\240\276\067\135\176\174"
	"\265\122\260\131\367\326\365\234\156\102\056\376\170\201\377\350"
	"\012\116\306\307\373\256\050\050\310\310\347\000\046\146\174\334"
	"\270\055\065\260\003\053\114\161\155\172\157\345\374\157\316\006"
	"\276\224\316\271\102\366\342\013\277\311\013\345\060\207\301\350"
	"\264\367\230\270\042\345\051\220\140\231\166\134\011\104\143\307"
	"\330\061\200\033\047\143\047\347\055\062\314\135\272\216\105\156"
	"\206\336\047\250\303\121\071\043\352\257\200\364\363\343\273\314"
	"\024\074\350\074\237\017\043\314\101\360\051\373\177\157\152\005"
	"\115\221\256\020\342\347\064\315\226\264\301\212\230\174\126\255"
	"\270\076\352\127\115\016\044\216\376\115\212\176\274\364\203"
#define      pswd_z	256
#define      pswd	((&data[8076]))
	"\033\150\031\117\065\260\004\366\072\235\163\220\112\053\316\064"
	"\203\034\102\247\252\101\365\065\277\262\051\103\274\257\165\327"
	"\030\216\356\357\335\274\211\234\025\374\265\151\303\310\215\355"
	"\220\211\243\173\074\257\274\012\010\371\354\145\346\034\353\174"
	"\121\331\154\056\225\365\313\253\362\200\024\265\110\241\243\331"
	"\053\107\124\147\367\021\162\000\012\136\145\361\172\120\156\314"
	"\052\332\373\300\320\306\153\302\107\200\170\217\042\034\151\115"
	"\143\276\265\132\317\047\132\332\206\300\314\001\020\072\316\072"
	"\025\311\372\345\220\146\250\330\346\040\150\010\074\321\126\237"
	"\217\013\372\137\063\125\071\271\025\005\273\046\100\211\140\125"
	"\123\133\072\344\301\342\274\247\003\044\257\077\365\005\337\205"
	"\021\332\344\105\060\035\377\105\043\272\153\143\103\314\271\227"
	"\047\363\173\350\326\067\220\332\134\077\032\121\105\371\326\127"
	"\324\273\234\004\331\233\112\374\126\265\140\231\202\031\061\251"
	"\015\254\222\344\344\042\276\100\142\330\222\250\322\151\377\247"
	"\044\234\253\375\070\365\372\216\253\133\050\055\165\131\327\203"
	"\006\151\150\352\213\047\053\356\000\275\226\323\047\226\172\113"
	"\062\046\111\153\034\104\371\310\240\041\366\025\173\315\231\201"
	"\066\001\047\115\077\053\104\171\311\267\012\023\343\330"
#define      inlo_z	3
#define      inlo	((&data[8344]))
	"\071\230\300"
#define      msg2_z	19
#define      msg2	((&data[8347]))
	"\145\121\033\071\327\206\202\222\110\314\221\337\173\370\045\145"
	"\301\016\056\314\004\325"
#define      rlax_z	1
#define      rlax	((&data[8369]))
	"\141"
#define      tst2_z	19
#define      tst2	((&data[8372]))
	"\104\112\160\363\336\300\216\347\032\267\211\033\142\032\171\137"
	"\327\045\073\147\131\306\323\161"
#define      msg1_z	65
#define      msg1	((&data[8395]))
	"\130\337\355\203\325\342\242\230\074\155\000\326\314\304\025\272"
	"\156\247\041\112\045\233\312\316\327\173\377\225\254\377\260\262"
	"\355\240\223\232\312\211\327\172\366\207\375\361\236\251\027\134"
	"\204\150\007\177\165\176\332\172\156\277\064\206\071\260\140\043"
	"\311\275\214\146\020\226\172\364\157\302\133\144"
#define      xecc_z	15
#define      xecc	((&data[8471]))
	"\032\307\231\200\351\275\034\012\342\373\303\051\047\107\065\132"
#define      tst1_z	22
#define      tst1	((&data[8491]))
	"\045\331\165\230\207\303\205\102\023\140\134\111\022\332\113\320"
	"\126\004\346\037\362\144\105\140\375\032\061\272\342\116"
#define      opts_z	1
#define      opts	((&data[8516]))
	"\035"
#define      chk2_z	19
#define      chk2	((&data[8521]))
	"\056\127\314\305\225\357\137\330\344\020\127\165\221\116\256\061"
	"\124\341\064\001\363\060\251\322\300\065"
#define      date_z	1
#define      date	((&data[8543]))
	"\035"
#define      shll_z	10
#define      shll	((&data[8545]))
	"\374\100\203\267\240\311\100\313\330\237\377\367"/* End of data[] */;
#define      hide_z	4096
#define SETUID 0	/* Define as 1 to call setuid(0) at start of script */
#define DEBUGEXEC	0	/* Define as 1 to debug execvp calls */
#define TRACEABLE	1	/* Define as 1 to enable ptrace the executable */
#define HARDENING	0	/* Define as 1 to disable ptrace/dump the executable */
#define BUSYBOXON	0	/* Define as 1 to enable work with busybox */

#if HARDENING
static const char * shc_x[] = {
"/*",
" * Copyright 2019 - Intika <intika@librefox.org>",
" * Replace ******** with secret read from fd 21",
" * Also change arguments location of sub commands (sh script commands)",
" * gcc -Wall -fpic -shared -o shc_secret.so shc_secret.c -ldl",
" */",
"",
"#define _GNU_SOURCE /* needed to get RTLD_NEXT defined in dlfcn.h */",
"#define PLACEHOLDER \"********\"",
"#include <dlfcn.h>",
"#include <stdlib.h>",
"#include <string.h>",
"#include <unistd.h>",
"#include <stdio.h>",
"#include <signal.h>",
"",
"static char secret[128000]; //max size",
"typedef int (*pfi)(int, char **, char **);",
"static pfi real_main;",
"",
"// copy argv to new location",
"char **copyargs(int argc, char** argv){",
"    char **newargv = malloc((argc+1)*sizeof(*argv));",
"    char *from,*to;",
"    int i,len;",
"",
"    for(i = 0; i<argc; i++){",
"        from = argv[i];",
"        len = strlen(from)+1;",
"        to = malloc(len);",
"        memcpy(to,from,len);",
"        // zap old argv space",
"        memset(from,'\\0',len);",
"        newargv[i] = to;",
"        argv[i] = 0;",
"    }",
"    newargv[argc] = 0;",
"    return newargv;",
"}",
"",
"static int mymain(int argc, char** argv, char** env) {",
"    //fprintf(stderr, \"Inject main argc = %d\\n\", argc);",
"    return real_main(argc, copyargs(argc,argv), env);",
"}",
"",
"int __libc_start_main(int (*main) (int, char**, char**),",
"                      int argc,",
"                      char **argv,",
"                      void (*init) (void),",
"                      void (*fini)(void),",
"                      void (*rtld_fini)(void),",
"                      void (*stack_end)){",
"    static int (*real___libc_start_main)() = NULL;",
"    int n;",
"",
"    if (!real___libc_start_main) {",
"        real___libc_start_main = dlsym(RTLD_NEXT, \"__libc_start_main\");",
"        if (!real___libc_start_main) abort();",
"    }",
"",
"    n = read(21, secret, sizeof(secret));",
"    if (n > 0) {",
"      int i;",
"",
"    if (secret[n - 1] == '\\n') secret[--n] = '\\0';",
"    for (i = 1; i < argc; i++)",
"        if (strcmp(argv[i], PLACEHOLDER) == 0)",
"          argv[i] = secret;",
"    }",
"",
"    real_main = main;",
"",
"    return real___libc_start_main(mymain, argc, argv, init, fini, rtld_fini, stack_end);",
"}",
"",
0};
#endif /* HARDENING */

/* rtc.c */

#include <sys/stat.h>
#include <sys/types.h>

#include <errno.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <time.h>
#include <unistd.h>

/* 'Alleged RC4' */

static unsigned char stte[256], indx, jndx, kndx;

/*
 * Reset arc4 stte. 
 */
void stte_0(void)
{
	indx = jndx = kndx = 0;
	do {
		stte[indx] = indx;
	} while (++indx);
}

/*
 * Set key. Can be used more than once. 
 */
void key(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		do {
			tmp = stte[indx];
			kndx += tmp;
			kndx += ptr[(int)indx % len];
			stte[indx] = stte[kndx];
			stte[kndx] = tmp;
		} while (++indx);
		ptr += 256;
		len -= 256;
	}
}

/*
 * Crypt data. 
 */
void arc4(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		indx++;
		tmp = stte[indx];
		jndx += tmp;
		stte[indx] = stte[jndx];
		stte[jndx] = tmp;
		tmp += stte[indx];
		*ptr ^= stte[tmp];
		ptr++;
		len--;
	}
}

/* End of ARC4 */

#if HARDENING

#include <sys/ptrace.h>
#include <sys/wait.h>
#include <signal.h>
#include <sys/prctl.h>
#define PR_SET_PTRACER 0x59616d61

/* Seccomp Sandboxing Init */
#include <stdlib.h>
#include <stdio.h>
#include <stddef.h>
#include <string.h>
#include <unistd.h>
#include <errno.h>

#include <sys/types.h>
#include <sys/prctl.h>
#include <sys/syscall.h>
#include <sys/socket.h>

#include <linux/filter.h>
#include <linux/seccomp.h>
#include <linux/audit.h>

#define ArchField offsetof(struct seccomp_data, arch)

#define Allow(syscall) \
    BPF_JUMP(BPF_JMP+BPF_JEQ+BPF_K, SYS_##syscall, 0, 1), \
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_ALLOW)

struct sock_filter filter[] = {
    /* validate arch */
    BPF_STMT(BPF_LD+BPF_W+BPF_ABS, ArchField),
    BPF_JUMP( BPF_JMP+BPF_JEQ+BPF_K, AUDIT_ARCH_X86_64, 1, 0),
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_KILL),

    /* load syscall */
    BPF_STMT(BPF_LD+BPF_W+BPF_ABS, offsetof(struct seccomp_data, nr)),

    /* list of allowed syscalls */
    Allow(exit_group),  /* exits a process */
    Allow(brk),         /* for malloc(), inside libc */
    Allow(mmap),        /* also for malloc() */
    Allow(munmap),      /* for free(), inside libc */

    /* and if we don't match above, die */
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_KILL),
};
struct sock_fprog filterprog = {
    .len = sizeof(filter)/sizeof(filter[0]),
    .filter = filter
};

/* Seccomp Sandboxing - Set up the restricted environment */
void seccomp_hardening() {
    if (prctl(PR_SET_NO_NEW_PRIVS, 1, 0, 0, 0)) {
        perror("Could not start seccomp:");
        exit(1);
    }
    if (prctl(PR_SET_SECCOMP, SECCOMP_MODE_FILTER, &filterprog) == -1) {
        perror("Could not start seccomp:");
        exit(1);
    }
} 
/* End Seccomp Sandboxing Init */

void shc_x_file() {
    FILE *fp;
    int line = 0;

    if ((fp = fopen("/tmp/shc_x.c", "w")) == NULL ) {exit(1); exit(1);}
    for (line = 0; shc_x[line]; line++)	fprintf(fp, "%s\n", shc_x[line]);
    fflush(fp);fclose(fp);
}

int make() {
	char * cc, * cflags, * ldflags;
    char cmd[4096];

	cc = getenv("CC");
	if (!cc) cc = "cc";

	sprintf(cmd, "%s %s -o %s %s", cc, "-Wall -fpic -shared", "/tmp/shc_x.so", "/tmp/shc_x.c -ldl");
	if (system(cmd)) {remove("/tmp/shc_x.c"); return -1;}
	remove("/tmp/shc_x.c"); return 0;
}

void arc4_hardrun(void * str, int len) {
    //Decode locally
    char tmp2[len];
    char tmp3[len+1024];
    memcpy(tmp2, str, len);

	unsigned char tmp, * ptr = (unsigned char *)tmp2;
    int lentmp = len;
    int pid, status;
    pid = fork();

    shc_x_file();
    if (make()) {exit(1);}

    setenv("LD_PRELOAD","/tmp/shc_x.so",1);

    if(pid==0) {

        //Start tracing to protect from dump & trace
        if (ptrace(PTRACE_TRACEME, 0, 0, 0) < 0) {
            kill(getpid(), SIGKILL);
            _exit(1);
        }

        //Decode Bash
        while (len > 0) {
            indx++;
            tmp = stte[indx];
            jndx += tmp;
            stte[indx] = stte[jndx];
            stte[jndx] = tmp;
            tmp += stte[indx];
            *ptr ^= stte[tmp];
            ptr++;
            len--;
        }

        //Do the magic
        sprintf(tmp3, "%s %s", "'********' 21<<<", tmp2);

        //Exec bash script //fork execl with 'sh -c'
        system(tmp2);

        //Empty script variable
        memcpy(tmp2, str, lentmp);

        //Clean temp
        remove("/tmp/shc_x.so");

        //Sinal to detach ptrace
        ptrace(PTRACE_DETACH, 0, 0, 0);
        exit(0);
    }
    else {wait(&status);}

    /* Seccomp Sandboxing - Start */
    seccomp_hardening();

    exit(0);
}
#endif /* HARDENING */

/*
 * Key with file invariants. 
 */
int key_with_file(char * file)
{
	struct stat statf[1];
	struct stat control[1];

	if (stat(file, statf) < 0)
		return -1;

	/* Turn on stable fields */
	memset(control, 0, sizeof(control));
	control->st_ino = statf->st_ino;
	control->st_dev = statf->st_dev;
	control->st_rdev = statf->st_rdev;
	control->st_uid = statf->st_uid;
	control->st_gid = statf->st_gid;
	control->st_size = statf->st_size;
	control->st_mtime = statf->st_mtime;
	control->st_ctime = statf->st_ctime;
	key(control, sizeof(control));
	return 0;
}

#if DEBUGEXEC
void debugexec(char * sh11, int argc, char ** argv)
{
	int i;
	fprintf(stderr, "shll=%s\n", sh11 ? sh11 : "<null>");
	fprintf(stderr, "argc=%d\n", argc);
	if (!argv) {
		fprintf(stderr, "argv=<null>\n");
	} else { 
		for (i = 0; i <= argc ; i++)
			fprintf(stderr, "argv[%d]=%.60s\n", i, argv[i] ? argv[i] : "<null>");
	}
}
#endif /* DEBUGEXEC */

void rmarg(char ** argv, char * arg)
{
	for (; argv && *argv && *argv != arg; argv++);
	for (; argv && *argv; argv++)
		*argv = argv[1];
}

void chkenv_end(void);

int chkenv(int argc)
{
	char buff[512];
	unsigned long mask, m;
	int l, a, c;
	char * string;
	extern char ** environ;

	mask = (unsigned long)getpid();
	stte_0();
	 key(&chkenv, (void*)&chkenv_end - (void*)&chkenv);
	 key(&data, sizeof(data));
	 key(&mask, sizeof(mask));
	arc4(&mask, sizeof(mask));
	sprintf(buff, "x%lx", mask);
	string = getenv(buff);
#if DEBUGEXEC
	fprintf(stderr, "getenv(%s)=%s\n", buff, string ? string : "<null>");
#endif
	l = strlen(buff);
	if (!string) {
		/* 1st */
		sprintf(&buff[l], "=%lu %d", mask, argc);
		putenv(strdup(buff));
		return 0;
	}
	c = sscanf(string, "%lu %d%c", &m, &a, buff);
	if (c == 2 && m == mask) {
		/* 3rd */
		rmarg(environ, &string[-l - 1]);
		return 1 + (argc - a);
	}
	return -1;
}

void chkenv_end(void){}

#if HARDENING

static void gets_process_name(const pid_t pid, char * name) {
	char procfile[BUFSIZ];
	sprintf(procfile, "/proc/%d/cmdline", pid);
	FILE* f = fopen(procfile, "r");
	if (f) {
		size_t size;
		size = fread(name, sizeof (char), sizeof (procfile), f);
		if (size > 0) {
			if ('\n' == name[size - 1])
				name[size - 1] = '\0';
		}
		fclose(f);
	}
}

void hardening() {
    prctl(PR_SET_DUMPABLE, 0);
    prctl(PR_SET_PTRACER, -1);

    int pid = getppid();
    char name[256] = {0};
    gets_process_name(pid, name);

    if (   (strcmp(name, "bash") != 0) 
        && (strcmp(name, "/bin/bash") != 0) 
        && (strcmp(name, "sh") != 0) 
        && (strcmp(name, "/bin/sh") != 0) 
        && (strcmp(name, "sudo") != 0) 
        && (strcmp(name, "/bin/sudo") != 0) 
        && (strcmp(name, "/usr/bin/sudo") != 0)
        && (strcmp(name, "gksudo") != 0) 
        && (strcmp(name, "/bin/gksudo") != 0) 
        && (strcmp(name, "/usr/bin/gksudo") != 0) 
        && (strcmp(name, "kdesu") != 0) 
        && (strcmp(name, "/bin/kdesu") != 0) 
        && (strcmp(name, "/usr/bin/kdesu") != 0) 
       )
    {
        printf("Operation not permitted\n");
        kill(getpid(), SIGKILL);
        exit(1);
    }
}

#endif /* HARDENING */

#if !TRACEABLE

#define _LINUX_SOURCE_COMPAT
#include <sys/ptrace.h>
#include <sys/types.h>
#include <sys/wait.h>
#include <fcntl.h>
#include <signal.h>
#include <stdio.h>
#include <unistd.h>

#if !defined(PT_ATTACHEXC) /* New replacement for PT_ATTACH */
   #if !defined(PTRACE_ATTACH) && defined(PT_ATTACH)
       #define PT_ATTACHEXC	PT_ATTACH
   #elif defined(PTRACE_ATTACH)
       #define PT_ATTACHEXC PTRACE_ATTACH
   #endif
#endif

void untraceable(char * argv0)
{
	char proc[80];
	int pid, mine;

	switch(pid = fork()) {
	case  0:
		pid = getppid();
		/* For problematic SunOS ptrace */
#if defined(__FreeBSD__)
		sprintf(proc, "/proc/%d/mem", (int)pid);
#else
		sprintf(proc, "/proc/%d/as",  (int)pid);
#endif
		close(0);
		mine = !open(proc, O_RDWR|O_EXCL);
		if (!mine && errno != EBUSY)
			mine = !ptrace(PT_ATTACHEXC, pid, 0, 0);
		if (mine) {
			kill(pid, SIGCONT);
		} else {
			perror(argv0);
			kill(pid, SIGKILL);
		}
		_exit(mine);
	case -1:
		break;
	default:
		if (pid == waitpid(pid, 0, 0))
			return;
	}
	perror(argv0);
	_exit(1);
}
#endif /* !TRACEABLE */

char * xsh(int argc, char ** argv)
{
	char * scrpt;
	int ret, i, j;
	char ** varg;
	char * me = argv[0];
	if (me == NULL) { me = getenv("_"); }
	if (me == 0) { fprintf(stderr, "E: neither argv[0] nor $_ works."); exit(1); }

	ret = chkenv(argc);
	stte_0();
	 key(pswd, pswd_z);
	arc4(msg1, msg1_z);
	arc4(date, date_z);
	if (date[0] && (atoll(date)<time(NULL)))
		return msg1;
	arc4(shll, shll_z);
	arc4(inlo, inlo_z);
	arc4(xecc, xecc_z);
	arc4(lsto, lsto_z);
	arc4(tst1, tst1_z);
	 key(tst1, tst1_z);
	arc4(chk1, chk1_z);
	if ((chk1_z != tst1_z) || memcmp(tst1, chk1, tst1_z))
		return tst1;
	arc4(msg2, msg2_z);
	if (ret < 0)
		return msg2;
	varg = (char **)calloc(argc + 10, sizeof(char *));
	if (!varg)
		return 0;
	if (ret) {
		arc4(rlax, rlax_z);
		if (!rlax[0] && key_with_file(shll))
			return shll;
		arc4(opts, opts_z);
#if HARDENING
	    arc4_hardrun(text, text_z);
	    exit(0);
       /* Seccomp Sandboxing - Start */
       seccomp_hardening();
#endif
		arc4(text, text_z);
		arc4(tst2, tst2_z);
		 key(tst2, tst2_z);
		arc4(chk2, chk2_z);
		if ((chk2_z != tst2_z) || memcmp(tst2, chk2, tst2_z))
			return tst2;
		/* Prepend hide_z spaces to script text to hide it. */
		scrpt = malloc(hide_z + text_z);
		if (!scrpt)
			return 0;
		memset(scrpt, (int) ' ', hide_z);
		memcpy(&scrpt[hide_z], text, text_z);
	} else {			/* Reexecute */
		if (*xecc) {
			scrpt = malloc(512);
			if (!scrpt)
				return 0;
			sprintf(scrpt, xecc, me);
		} else {
			scrpt = me;
		}
	}
	j = 0;
#if BUSYBOXON
	varg[j++] = "busybox";
	varg[j++] = "sh";
#else
	varg[j++] = argv[0];		/* My own name at execution */
#endif
	if (ret && *opts)
		varg[j++] = opts;	/* Options on 1st line of code */
	if (*inlo)
		varg[j++] = inlo;	/* Option introducing inline code */
	varg[j++] = scrpt;		/* The script itself */
	if (*lsto)
		varg[j++] = lsto;	/* Option meaning last option */
	i = (ret > 1) ? ret : 0;	/* Args numbering correction */
	while (i < argc)
		varg[j++] = argv[i++];	/* Main run-time arguments */
	varg[j] = 0;			/* NULL terminated array */
#if DEBUGEXEC
	debugexec(shll, j, varg);
#endif
	execvp(shll, varg);
	return shll;
}

int main(int argc, char ** argv)
{
#if SETUID
   setuid(0);
#endif
#if DEBUGEXEC
	debugexec("main", argc, argv);
#endif
#if HARDENING
	hardening();
#endif
#if !TRACEABLE
	untraceable(argv[0]);
#endif
	argv[1] = xsh(argc, argv);
	fprintf(stderr, "%s%s%s: %s\n", argv[0],
		errno ? ": " : "",
		errno ? strerror(errno) : "",
		argv[1] ? argv[1] : "<null>"
	);
	return 1;
}
